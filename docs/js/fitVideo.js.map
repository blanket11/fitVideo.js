{"version":3,"sources":["fitVideo.js"],"names":["FitVideo","target","options","document","querySelectorAll","$video","params","self","viewSize","drowSize","$","extend","_loopHandler","i","length","item","video","getElementsByTagName","_setSize","_applySize","_setEvent","window","addEventListener","width","Math","ceil","clientWidth","height","clientHeight","scaleH","size","scaleW","sw","scale","dx","dy","marginHeight","dw","dh","marginWidth","style","marginTop","marginLeft","removeEventListener","_cancelEvent","_resetSize"],"mappings":"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","file":"fitVideo.js","sourcesContent":["class FitVideo {\n  constructor(target, options = null) {\n    this.target = document.querySelectorAll(target);\n    this.options = options;\n    this.$video = null;\n\n    this.params = {\n      self: null,\n      viewSize: {},\n      drowSize: { // 操作する設定値\n        'sw': 0,// 動画元サイズ横幅\n        'sh': 0,// 動画元サイズ縦幅\n        'dx': 0,// 配置位置 X軸\n        'dy': 0,// 配置位置 Y軸\n        'dw': 0,// 表示領域横幅\n        'dh': 0// 表示領域縦幅\n      }\n    };\n\n    this.options = $.extend({\n      'size': {\n        'width': 1280,\n        'height': 720\n      }\n    }, options);\n\n    this._loopHandler = () => {\n      for(let i = 0; i < this.target.length; i++) {\n        let item = this.target[i];\n        this.params.self = item;\n        this.video = item.getElementsByTagName('video');\n        this._setSize();\n        this._applySize();\n      }\n    };\n\n    this._setEvent();\n  }\n\n\n  /**\n  * イベントの設定\n  */\n  _setEvent() {\n    window.addEventListener('load', this._loopHandler);\n    window.addEventListener('resize', this._loopHandler);\n  }\n\n\n  /**\n  * サイズの取得\n  */\n  _setSize() {\n    let width = Math.ceil(this.params.self.clientWidth);\n    let height = Math.ceil(this.params.self.clientHeight);\n    let scaleH = height / this.options.size.height;\n    let scaleW = width / this.options.size.width;\n    this.params.viewSize = {\n      'width': width,\n      'height': height,\n      'scale': scaleH,\n      'marginWidth': ((this.options.size.width * scaleH) - width) / 2,\n      'marginHeight': ((this.options.size.height * scaleW) - height) / 2\n    };\n\n    // 動画サイズ設定\n    this.params.drowSize.sw = this.options.size.width;\n    this.params.drowSize.sw = this.options.size.height;\n\n    if (width > this.options.size.width * scaleH) {\n      this.params.viewSize.scale = scaleW;\n\n      this.params.drowSize.dx = 0;\n      this.params.drowSize.dy = -(this.params.viewSize.marginHeight);\n      this.params.drowSize.dw = this.params.viewSize.width;\n      this.params.drowSize.dh = this.options.size.height * this.params.viewSize.scale;\n    } else {\n      this.params.viewSize.scale = scaleH;\n\n      this.params.drowSize.dx = -(this.params.viewSize.marginWidth);\n      this.params.drowSize.dy = 0;\n      this.params.drowSize.dw = this.options.size.width * this.params.viewSize.scale;\n      this.params.drowSize.dh = this.params.viewSize.height;\n    }\n  }\n\n\n  /**\n  * videoタグにサイズのstyleをつける\n  */\n  _applySize() {\n    for(let i = 0; i < this.video.length; i ++){\n      let item = this.video[i];\n      item.style.width = this.params.drowSize.dw+'px';\n      item.style.height = this.params.drowSize.dh+'px';\n      item.style.marginTop = this.params.drowSize.dy+'px';\n      item.style.marginLeft = this.params.drowSize.dx+'px';\n    }\n  }\n\n\n  /**\n  * videoタグのstyleを解除\n  */\n  _resetSize() {\n    this.video = this.params.self.getElementsByTagName('video');\n    for(let i = 0; i < this.video.length; i ++){\n      let item = this.video[i];\n      item.style.width = '';\n      item.style.height = '';\n      item.style.marginTop = '';\n      item.style.marginLeft = '';\n    }\n  }\n\n\n  /**\n  * イベントを解除\n  */\n  _cancelEvent() {\n    window.removeEventListener('load', this._loopHandler);\n    window.removeEventListener('resize', this._loopHandler);\n  }\n\n\n  /**\n  * 解除処理\n  */\n  destroy() {\n    this._cancelEvent();\n    // ライブラリ側で設定したものを解除\n    for(let i = 0; i < this.target.length; i++){\n      let item = this.target[i];\n      this.params.self = item;\n      this.video = item.getElementsByTagName('video');\n      this._resetSize();\n    }\n  }\n}\n"]}